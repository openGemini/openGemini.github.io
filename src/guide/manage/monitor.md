---
title: Monitor
order: 5
---


# Monitor
openGemini provides 260+ monitoring indicators to monitor various states of the cluster. 
Below, we will introduce how to enable monitoring items and visualize this data with Grafana. 
To demonstrate this, we will use the `install_cluster.sh` 
and `install_monitor.sh` script files under the `scripts` directory to simulate cluster deployment on a single machine.
## Kernel configuration file

Configure the following settings in openGemini.conf:

```editorconfig
[monitor]
   pushers = "http"
   store-enabled = true
   store-database = "_internal"
   store-interval = "10s"
   # store-path = "/tmp/openGemini/metric/{{id}}/metric.data"
   # compress = false
   http-endpoint = "127.0.0.1:8086"
   # username = ""
   # password = ""

[http]
  bind-address = "{{addr}}:8086"
```

- `pushers`: represents the method of pushing monitoring indicators. Currently, two methods are supported: http and file. You can use http|file to indicate that both methods should be used.
- `store-enable`: indicates whether to enable monitoring data storage.
- `store-database`: specifies the name of the database where the monitoring indicators will be saved.
- `store-interval`: specifies the interval for storing data.
- `store-path`: only effective when file is included in pushers, specifies the path and file name template for saving the monitoring indicators.
- `http-endpoint`: specifies the endpoint where the monitoring indicators will be sent via HTTP.

::: tip

127.0.0.1:8086 is used here, with the same port as configured in [http] below, 
indicating that the monitoring indicators will be sent to the openGemini database node exposed on 127.0.0.1:8086.
:::

## ts-monitor configuration file
The configuration file for `monitor` has detailed comments in the provided template configuration file.

```editorconfig
[monitor]
    # localhost ip
    host = "{{addr}}"
    # Indicates the path of the metric file generated by the kernel. References openGemini.conf: [monitor] store-path
    # metric-path cannot have subdirectories
    metric-path = "/tmp/openGemini/metric"
    # Indicates the path of the log file generated by the kernel. References openGemini.conf: [logging] path
    # error-log-path cannot have subdirectories
    error-log-path = "/tmp/openGemini/logs"
    # Data disk path. References openGemini.conf: [data] store-data-dir
    disk-path = "/tmp/openGemini/data"
    # Wal disk path. References openGemini.conf: [data]  store-wal-dir
    aux-disk-path = "/tmp/openGemini/data/wal"
    # Name of the process to be monitored. Optional Value: ts-store,ts-sql,ts-meta.
    # Determined based on the actual process running on the local node.
    process = "ts-store,ts-sql,ts-meta"
    # the history file reported error-log names.
    history-file = "history.txt"
    # Is the metric compressed.
    compress = false

[report]
    # Address for metric data to be reported.
    address = "{{report_addr}}:8086"
    # Database name for metric data to be reported.
    database = "monitor"
    rp = "autogen"
    rp-duration = "168h"
```

## grafana
1. Start the cluster and ts-monitor

    - input the following command in the OpenGemini project directory:
    ```shell
    bash scripts/install_cluster.sh
    bash scripts/install_monitor.sh 
    ```
    - Use the `ps` command to check if the startup is successful. 
   You should see a response similar to the following, indicating that 3 meta, 3 store, 1 sql, and 1 ts-monitor have been started:
    ```shell
    PID TTY          TIME CMD
    346114 pts/28   00:00:00 bash
    346353 pts/28   00:00:51 ts-meta
    346354 pts/28   00:00:50 ts-meta
    346355 pts/28   00:02:07 ts-meta
    346419 pts/28   00:01:12 ts-store
    346432 pts/28   00:00:51 ts-store
    346461 pts/28   00:00:55 ts-store
    346474 pts/28   00:00:28 ts-sql
    357880 pts/28   00:00:03 ts-monitor
    382071 pts/28   00:00:00 ps
    ```
    
2. Configure Grafana and view monitoring data

   - Since OpenGemini is the same as the protocol of influxdb, select influxdb when configuring the data source
   
   ![](../../../static/img/guide/manage/monitor/dbsource.png)
   
   - Add dashboards, add or import some existing JSON configuration files, you can see OpenGemini monitoring data in grafana
   
   ![](../../../static/img/guide/manage/monitor/dashboard.png)
